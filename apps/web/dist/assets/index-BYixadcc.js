import{r as a,a as E,R as L}from"./vendor-nf7bT_Uh.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const c of t)if(c.type==="childList")for(const p of c.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&i(p)}).observe(document,{childList:!0,subtree:!0});function h(t){const c={};return t.integrity&&(c.integrity=t.integrity),t.referrerPolicy&&(c.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?c.credentials="include":t.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(t){if(t.ep)return;t.ep=!0;const c=h(t);fetch(t.href,c)}})();var j={exports:{}},m={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O=a,S=Symbol.for("react.element"),_=Symbol.for("react.fragment"),T=Object.prototype.hasOwnProperty,U=O.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,G={key:!0,ref:!0,__self:!0,__source:!0};function y(e,l,h){var i,t={},c=null,p=null;h!==void 0&&(c=""+h),l.key!==void 0&&(c=""+l.key),l.ref!==void 0&&(p=l.ref);for(i in l)T.call(l,i)&&!G.hasOwnProperty(i)&&(t[i]=l[i]);if(e&&e.defaultProps)for(i in l=e.defaultProps,l)t[i]===void 0&&(t[i]=l[i]);return{$$typeof:S,type:e,key:c,ref:p,props:t,_owner:U.current}}m.Fragment=_;m.jsx=y;m.jsxs=y;j.exports=m;var r=j.exports,x={},b=E;x.createRoot=b.createRoot,x.hydrateRoot=b.hydrateRoot;function V(e,l,h=[]){const i=a.useRef(null),t=a.useCallback((...c)=>{i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{e(...c)},l)},[e,l,...h]);return a.useEffect(()=>()=>{i.current&&clearTimeout(i.current)},[]),t}const z=()=>{const[e,l]=a.useState({selectedFile:null,fidelity:50,whiteFill:!1,useAI:!1,isProcessing:!1,result:null,error:null,svgPreview:null}),h=a.useRef(null),i=a.useRef(null),t=V(async(s,n,o,d)=>{if(s){l(u=>({...u,isProcessing:!0,error:null}));try{const u=new FormData;u.append("image",s),u.append("fidelity",n.toString()),u.append("whiteFill",o.toString()),u.append("useAI",d.toString());const f=await fetch("/api/trace",{method:"POST",body:u});if(!f.ok){const g=await f.json();throw new Error(g.error||"Processing failed")}const v=await f.json();l(g=>({...g,result:v,svgPreview:v.svg,isProcessing:!1,error:null}))}catch(u){console.error("Trace processing error:",u),l(f=>({...f,error:u instanceof Error?u.message:"Unknown error occurred",isProcessing:!1}))}}},500,[e.selectedFile,e.fidelity,e.whiteFill,e.useAI]),c=a.useCallback(s=>{if(!s.type.startsWith("image/png")){l(n=>({...n,error:"Please select a PNG file"}));return}l(n=>({...n,selectedFile:s,error:null,result:null,svgPreview:null})),t(s,e.fidelity,e.whiteFill,e.useAI)},[e.fidelity,e.whiteFill,e.useAI,t]),p=a.useCallback(s=>{var o;const n=(o=s.target.files)==null?void 0:o[0];n&&c(n)},[c]),F=a.useCallback(s=>{s.preventDefault(),s.stopPropagation()},[]),N=a.useCallback(s=>{s.preventDefault(),s.stopPropagation(),i.current&&i.current.classList.add("drag-over")},[]),k=a.useCallback(s=>{s.preventDefault(),s.stopPropagation(),i.current&&!i.current.contains(s.relatedTarget)&&i.current.classList.remove("drag-over")},[]),P=a.useCallback(s=>{s.preventDefault(),s.stopPropagation(),i.current&&i.current.classList.remove("drag-over");const o=Array.from(s.dataTransfer.files).find(d=>d.type==="image/png");o?c(o):l(d=>({...d,error:"Please drop a PNG file"}))},[c]),C=a.useCallback(s=>{const n=parseInt(s.target.value,10);l(o=>({...o,fidelity:n})),e.selectedFile&&t(e.selectedFile,n,e.whiteFill,e.useAI)},[e.selectedFile,e.whiteFill,e.useAI,t]),D=a.useCallback(s=>{const n=s.target.checked;l(o=>({...o,whiteFill:n})),e.selectedFile&&t(e.selectedFile,e.fidelity,n,e.useAI)},[e.selectedFile,e.fidelity,e.useAI,t]),R=a.useCallback(s=>{const n=s.target.checked;l(o=>({...o,useAI:n})),e.selectedFile&&t(e.selectedFile,e.fidelity,e.whiteFill,n)},[e.selectedFile,e.fidelity,e.whiteFill,t]),I=a.useCallback(()=>{var d;if(!e.result)return;const s=new Blob([e.result.svg],{type:"image/svg+xml"}),n=URL.createObjectURL(s),o=document.createElement("a");o.href=n,o.download=`${((d=e.selectedFile)==null?void 0:d.name.replace(".png",""))||"vectorized"}.svg`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(n)},[e.result,e.selectedFile]),A=a.useCallback(()=>{var u;if(!e.result)return;const s=atob(e.result.dxf),n=new Blob([s],{type:"application/dxf"}),o=URL.createObjectURL(n),d=document.createElement("a");d.href=o,d.download=`${((u=e.selectedFile)==null?void 0:u.name.replace(".png",""))||"vectorized"}.dxf`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(o)},[e.result,e.selectedFile]);return r.jsxs("div",{className:"app",children:[r.jsxs("div",{className:"header",children:[r.jsx("h1",{children:"PNG2Vector"}),r.jsx("p",{children:"AI-Assisted CAD Vectorizer for Vectorworks & ArchiCAD"})]}),r.jsxs("div",{className:"main-content",children:[r.jsxs("div",{className:"upload-section",children:[r.jsxs("div",{ref:i,className:"drop-zone",onDragOver:F,onDragEnter:N,onDragLeave:k,onDrop:P,onClick:()=>{var s;return(s=h.current)==null?void 0:s.click()},role:"button",tabIndex:0,"aria-label":"Click to select PNG file or drag and drop",children:[r.jsx("input",{ref:h,type:"file",className:"file-input",accept:"image/png",onChange:p,"aria-label":"PNG file input"}),e.selectedFile?r.jsxs("div",{children:[r.jsx("p",{children:r.jsx("strong",{children:e.selectedFile.name})}),r.jsx("p",{children:"Click to select a different file"})]}):r.jsxs("div",{children:[r.jsx("p",{children:"Drag & drop a PNG file here"}),r.jsx("p",{children:"or click to select"})]})]}),r.jsxs("div",{className:"controls",children:[r.jsxs("div",{className:"control-group",children:[r.jsxs("label",{htmlFor:"fidelity-slider",children:["Fidelity: ",e.fidelity,"%"]}),r.jsx("input",{id:"fidelity-slider",type:"range",min:"0",max:"100",value:e.fidelity,onChange:C,className:"slider","aria-label":"Fidelity level from 0 to 100 percent"}),r.jsx("small",{children:"Higher values preserve more detail but increase file size"})]}),r.jsxs("div",{className:"checkbox-group",children:[r.jsx("input",{id:"white-fill-checkbox",type:"checkbox",checked:e.whiteFill,onChange:D,className:"checkbox","aria-label":"Enable white fill for shapes"}),r.jsx("label",{htmlFor:"white-fill-checkbox",children:"White Fill"})]}),r.jsxs("div",{className:"checkbox-group",children:[r.jsx("input",{id:"use-ai-checkbox",type:"checkbox",checked:e.useAI,onChange:R,className:"checkbox","aria-label":"Enable AI-assisted preprocessing"}),r.jsx("label",{htmlFor:"use-ai-checkbox",children:"AI Enhancement"})]})]}),e.error&&r.jsx("div",{className:"error",role:"alert",children:e.error})]}),r.jsxs("div",{className:"preview-section",children:[r.jsx("h3",{children:"Preview"}),r.jsx("div",{className:"preview-container",children:e.isProcessing?r.jsx("div",{className:"processing",children:r.jsx("p",{children:"Processing..."})}):e.svgPreview?r.jsx("div",{dangerouslySetInnerHTML:{__html:e.svgPreview},className:"preview-svg"}):r.jsx("div",{className:"processing",children:r.jsx("p",{children:"Select a PNG file to see preview"})})}),r.jsxs("div",{className:"download-buttons",children:[r.jsx("button",{className:"btn btn-primary",onClick:I,disabled:!e.result||e.isProcessing,"aria-label":"Download SVG file",children:"Download SVG"}),r.jsx("button",{className:"btn btn-secondary",onClick:A,disabled:!e.result||e.isProcessing,"aria-label":"Download DXF file",children:"Download DXF"})]}),e.result&&r.jsxs("div",{className:"metrics",children:[r.jsx("h4",{children:"Processing Metrics"}),r.jsxs("div",{className:"metrics-grid",children:[r.jsxs("div",{className:"metric",children:[r.jsx("span",{children:"Polygons:"}),r.jsx("span",{children:e.result.metrics.polygonCount})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{children:"Nodes:"}),r.jsx("span",{children:e.result.metrics.nodeCount})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{children:"Simplification:"}),r.jsx("span",{children:e.result.metrics.simplification.toFixed(2)})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{children:"Total Time:"}),r.jsxs("span",{children:[e.result.metrics.timings.total,"ms"]})]})]})]})]})]})]})},w=document.getElementById("root");if(!w)throw new Error("Failed to find the root element");x.createRoot(w).render(r.jsx(L.StrictMode,{children:r.jsx(z,{})}));
//# sourceMappingURL=index-BYixadcc.js.map
